
  0%|                                                                                                      | 0/3906 [00:00<?, ?it/s]
> /home/ayhan/gflownet-rl/hypergrid/algorithms/pcl_ms_dqn.py(96)get_scores()
-> if states.batch_shape != tuple(actions.batch_shape):
HyperGridStates object of batch shape (28, 256) and state shape (4,)
DiscreteEnvActions object of batch shape (27, 256).
          The subclass did not implement __repr__.
*** TypeError: can't convert cuda:4 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
*** TypeError: can't convert cuda:4 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
*** AttributeError: 'Trajectories' object has no attribute 'shape'
*** AttributeError: 'Trajectories' object has no attribute 'size'
*** TypeError: can't convert cuda:4 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
HyperGridStates object of batch shape (28, 256) and state shape (4,)
DiscreteEnvActions object of batch shape (27, 256).
          The subclass did not implement __repr__.
DiscreteEnvActions object of batch shape (27, 256).
          The subclass did not implement __repr__.
DiscreteEnvActions object of batch shape (27, 256).
          The subclass did not implement __repr__.
256
tensor([ 9,  5,  8,  1,  1, 27,  4,  1,  2,  2,  2,  7, 20,  1,  4,  9,  2,  1,
         6,  1,  2, 11, 15,  6,  1,  1,  2,  8,  3,  3,  2,  8,  5, 10,  2,  1,
         1,  9, 10,  6,  4, 11,  3,  3, 11,  2,  2,  8,  7, 17, 13,  1,  3,  1,
         3,  1, 11,  4,  3,  1,  3,  5,  1,  5,  8,  6,  2,  1,  8, 18,  1,  2,
         4,  2,  2,  9,  1,  1,  9,  9,  7,  2, 16,  1,  5, 14,  2, 17,  6, 15,
         1,  2,  1, 20,  1,  5,  9,  5,  3,  1, 15,  2, 11,  1,  8,  1, 11,  1,
         6,  5, 17, 10,  5, 10,  1,  6,  3,  1,  6,  6, 17,  1,  4,  1,  4,  2,
        10,  2,  2,  1, 16,  3,  3,  6,  8,  1,  3,  9,  1,  3,  2,  5,  5,  6,
         6,  9,  4,  3,  4,  8,  2,  1,  4,  3,  2,  6,  4,  3,  6,  4,  5, 14,
         2,  2,  2,  8,  6, 10,  2,  3, 12,  1,  3,  2,  4,  9,  5,  5,  2,  7,
         2,  3, 14,  9,  5,  2,  3,  7,  1, 13,  1,  2,  1,  4, 13,  2,  2,  8,
         9,  5,  1,  4,  5,  1, 13,  3,  2, 11,  2,  5,  2,  7,  5,  2,  1,  5,
         1,  1,  1,  3,  7,  3,  1,  1, 15,  4,  6,  5,  5, 20,  2,  1,  3,  3,
        13,  3,  4,  1,  6,  4,  3,  3,  7,  1, 10,  8,  1, 16, 10,  4,  5, 16,
         1,  4,  1, 15], device='cuda:4')
HyperGridStates object of batch shape (256,) and state shape (4,)
HyperGridStates object of batch shape (256,) and state shape (4,)
27
(28, 256)
256
*** AttributeError: 'int' object has no attribute 'dtype'
  0%|                                                                                                    | 0/3906 [1:29:48<?, ?it/s]
Traceback (most recent call last):
  File "/home/ayhan/gflownet-rl/hypergrid/run_hypergrid_exp.py", line 104, in <module>
    app.run(main)
  File "/root/miniconda3/envs/gflownet-rl/lib/python3.10/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/root/miniconda3/envs/gflownet-rl/lib/python3.10/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/home/ayhan/gflownet-rl/hypergrid/run_hypergrid_exp.py", line 100, in main
    train_fns[algo_args.name](env, experiment_name, general_args, algo_args)
  File "/home/ayhan/gflownet-rl/hypergrid/experiments/train_pcl_ms_dqn.py", line 155, in train_pcl_ms_dqn
    scores = gflownet.get_scores(trajectories)
  File "/home/ayhan/gflownet-rl/hypergrid/algorithms/pcl_ms_dqn.py", line 96, in get_scores
    module_output = self.q(valid_states)
  File "/home/ayhan/gflownet-rl/hypergrid/algorithms/pcl_ms_dqn.py", line 96, in get_scores
    module_output = self.q(valid_states)
  File "/root/miniconda3/envs/gflownet-rl/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/root/miniconda3/envs/gflownet-rl/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit